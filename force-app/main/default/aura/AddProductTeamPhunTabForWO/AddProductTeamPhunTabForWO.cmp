<aura:component
  controller="AddProductTeamPhunTabForWOController"
  implements="force:lightningQuickActionWithoutHeader,force:appHostable,lightning:actionOverride,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes"
>
  <aura:attribute
    name="recordFrom"
    type="String"
    access="public"
  ></aura:attribute>
  <aura:attribute
    name="workOrderId"
    type="String"
    access="public"
  ></aura:attribute>
  <aura:attribute
    name="opportunityId"
    type="String"
    access="public"
  ></aura:attribute>
  <aura:attribute name="tabname" type="String"></aura:attribute>
  <aura:attribute name="isFilter" type="boolean" default="true" />
  <aura:attribute name="SpinnerTeamPhun" type="boolean" default="false" />
  <aura:attribute name="productList" type="List" />
  <aura:attribute name="currentPageNumber" type="Integer" default="1" />
  <aura:attribute name="currentPage" type="Integer" default="1" />
  <aura:attribute name="totalProducts" type="Integer" default="1" />

  <!-- saerch fields -->
  <div
    class="slds-grid slds-grid_vertical-align-end slds-grid_align-space"
    style="
      flex-wrap: wrap;
      justify-content: left;
      padding-left: 20px;
      padding-right: 20px;
      padding-top: 10px;
    "
  >
    <div class="slds-col dynamicFiter" onkeypress="{!c.keyCheck}">
      <lightning:input
        aura:id="searchName"
        name="searchTerm"
        placeholder="Search Term"
        isLoading="{!v.issearching }"
        type="search"
      />
    </div>
    <div class="slds-col dynamicFiter">
      <lightning:select aura:id="Supplier" name="Supplier" required="false">
        <option value="">Supplier</option>
        <option value="POL Test Vendor">POL Test Vendor</option>
        <option value="SkuBot Promo Limited">SkuBot Promo Limited</option>
      </lightning:select>
    </div>
    <div class="slds-col dynamicFiter" onkeypress="{!c.keyCheck}">
      <lightning:input aura:id="NetMin" name="NetMin" placeholder="Net Min" />
    </div>
    <div class="slds-col dynamicFiter" onkeypress="{!c.keyCheck}">
      <lightning:input aura:id="NetMax" name="NetMax" placeholder="Net Max" />
    </div>

    <div class="slds-col" style="padding-left: 20px">
      <lightning:button
        name="Search"
        variant="brand"
        label="Search"
        title="Search"
        onclick="{!c.handleSearchClick }"
      />
      <lightning:button
        name="Search"
        label="Reset"
        title="Reset"
        onclick="{!c.handleResetClick}"
      />
    </div>
  </div>
  <!-- spinner -->
  <aura:if isTrue="{!v.SpinnerTeamPhun}">
    <div
      id="lite_box_loading_overlay"
      style="
        position: fixed;
        background-color: rgba(0, 0, 0, 0.7);
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        z-index: 9999999 !important;
      "
    >
      <div
        id="lite_box_loading_overlay_inner"
        style="
          position: absolute;
          top: 50%;
          left: 50%;
          z-index: 9999 !important;
          -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
          border-radius: 0;
          -webkit-margin-before: -2%;
        "
      >
        <lightning:spinner variant="brand" size="large" />
      </div>
    </div>
  </aura:if>
  <!-- List of products -->
  <div style="padding: 11px">
    <!-- Lightning card to show contacts -->
    <aura:if isTrue="{! not(empty(v.productList))}">
      <lightning:card title="{! 'Products (' + v.totalProducts+')'}">
        <!-- Body of lightning card starts here -->
        <p class="slds-p-horizontal_small">
          <div
            class="slds-grid slds-grid--pull-padded"
            style="display: block !important"
          >
            <div
              style="margin: 5px; flex-wrap: wrap"
              class="slds-accordion__summary"
            >
              <aura:iteration items="{!v.productList}" var="product">
                <div style="padding: 5px; width: 100%" class="adjustGrid">
                  <lightning:recordViewForm>
                    <!--recordId="{!product.Id}" -->
                    <div
                      class="slds-box slds-theme_default"
                      style="position: relative; height: 210px; width: 100%"
                    >
                      <article class="slds-card slds-card--narrow">
                        <table>
                          <tr>
                            <td
                              style="
                                vertical-align: top;
                                padding-right: 20px;
                                width: 10%;
                              "
                            >
                              <div
                                style="width: 150px; height: 150px"
                                class="slds-float--right"
                              >
                                <aura:if
                                  isTrue="{!not(empty(product.imageUrl))}"
                                >
                                  <div
                                    style="
                                      box-sizing: border-box;
                                      border-style: groove;
                                      border-width: 1px;
                                      border-top-left-radius: var(
                                        --lwc-borderRadiusMedium,
                                        0.25rem
                                      );
                                      border-top-right-radius: var(
                                        --lwc-borderRadiusMedium,
                                        0.25rem
                                      );
                                      border-bottom-left-radius: var(
                                        --lwc-borderRadiusMedium,
                                        0.25rem
                                      );
                                      border-bottom-right-radius: var(
                                        --lwc-borderRadiusMedium,
                                        0.25rem
                                      );
                                    "
                                  >
                                    <img
                                      style="
                                        width: 145px;
                                        height: 145px;
                                        margin: 2px;
                                      "
                                      src="{!$Label.c.ContentVersionImage+product.imageUrl}"
                                    />
                                  </div>
                                  <aura:set attribute="else">
                                    <lightning:carouselImage
                                      src="{!$Resource.No_Image_Available}"
                                      class="slds-p-top_none"
                                      header=""
                                      description=""
                                      alternativeText="Product Image"
                                    >
                                    </lightning:carouselImage>
                                  </aura:set>
                                </aura:if>
                              </div>
                            </td>
                            <td style="width: 50%">
                              <div
                                class="slds-grid"
                                style="display: block !important"
                              >
                                <div class="slds-col">
                                  <label
                                    style="
                                      font-size: 15px;
                                      font-weight: bold;
                                      color: mediumblue;
                                    "
                                  >
                                    {!product.name}
                                  </label>
                                </div>

                                <div class="slds-col">
                                  <aura:if
                                    isTrue="{!not(empty(product.ProductCode))}"
                                  >
                                    <label
                                      style="font-weight: bold; font-size: 13px"
                                    >
                                      {!product.ProductCode}
                                    </label>
                                  </aura:if>
                                  <aura:if
                                    isTrue="{!not(empty(product.commonSkuId))}"
                                  >
                                    <label
                                      style="
                                        font-style: italic;
                                        font-weight: bold;
                                        font-size: 13px;
                                        color: gray;
                                      "
                                    >
                                      | {!product.commonSkuId}</label
                                    >
                                  </aura:if>
                                </div>
                                <div class="slds-col">
                                  <div class="">
                                    <aura:if
                                      isTrue="{!not(empty(product.supplier))}"
                                    >
                                      <label
                                        style="
                                          font-weight: bold;
                                          font-size: 14px;
                                        "
                                      >
                                        {!product.supplier}
                                      </label>
                                    </aura:if>
                                    <aura:if
                                      isTrue="{!not(empty(product.productSupplierCode))}"
                                    >
                                      <a
                                        style="
                                          font-style: italic;
                                          pointer-events: none;
                                        "
                                      >
                                        asi/{!product.productSupplierCode}</a
                                      >
                                    </aura:if>
                                  </div>
                                </div>
                                <div class="slds-col">
                                  <aura:if
                                    isTrue="{!not(empty(product.productColor))}"
                                  >
                                    <div class="">
                                      <label style="font-weight: bold"
                                        >Colors:</label
                                      >
                                      <label class="tags_data_padding">
                                        {!product.productColor}
                                      </label>
                                    </div>
                                  </aura:if>
                                </div>
                                <div class="slds-col">
                                  <aura:if
                                    isTrue="{!not(empty(product.productSize))}"
                                  >
                                    <div class="">
                                      <label style="font-weight: bold"
                                        >Sizes:</label
                                      >
                                      <label class="tags_data_padding">
                                        {!product.productSize}
                                      </label>
                                    </div>
                                  </aura:if>
                                </div>
                                <div class="slds-col">
                                  <a
                                    data-value="{!product.id}"
                                    onclick="{!c.openPopupSearchView}"
                                  >
                                    + More
                                  </a>
                                </div>

                                <!--  <div class="slds-col">                                        
                                                                    <div class="slds-card__body"><span class="slds-badge float_text">NetPrice :</span>
                                                                        <label class="tags_data_padding text_adjustment">
                                                                            ${!product.netPrice}
                                                                        </label></div> 
                                                                </div>
        
                                                                <div class="slds-col">
                                                                    <div class="slds-card__body"><span class="slds-badge float_text">Brand:</span>
                                                                    <label class="tags_data_padding text_adjustment">
                                                                        {!product.productBrand}
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            
                                                                <div class="slds-card__body" >
                                                                    <span class="slds-badge">Description:</span>
                                                                    <br/><p class="dyn-height">
                                                                    {!product.description}
                                                                    </p>
                                                                </div> -->
                              </div>
                            </td>
                            <td style="vertical-align: top; width: 40%">
                              <div
                                class="slds-grid"
                                style="float: right; display: block !important"
                              >
                                <div class="slds-col">
                                  <div class="">
                                    <span>PRICE : </span>
                                    <label style="font-weight: bold">
                                      ${!product.netPrice}
                                    </label>
                                  </div>
                                </div>
                                <div class="slds-col">
                                  <div class="">
                                    <span>COST : </span>
                                    <label style="font-weight: bold">
                                      ${!product.productCost}
                                    </label>
                                  </div>
                                </div>
                              </div>
                            </td>
                          </tr>
                        </table>
                      </article>
                      <div
                        onclick="{! c.handleAddProduct }"
                        data-value="{!product.id}"
                        style="position: absolute; bottom: 10px; right: 15px"
                      >
                        <lightning:button
                          variant="brand"
                          label="Add Product"
                          aura:id="{!product.Id}"
                        />
                      </div>
                    </div>
                  </lightning:recordViewForm>
                </div>
              </aura:iteration>
            </div>
            <div class="slds-grid slds-grid--pull-padded" style="padding: 20px">
              <div class="slds-col--padded slds-size--1-of-5"></div>
              <div class="slds-col--padded slds-size--1-of-5"></div>
              <div class="slds-col--padded slds-size--1-of-5">
                Page {!v.currentPageNumber}
              </div>
              <div class="slds-col--padded slds-size--1-of-5"></div>
              <div
                style="text-align: right; padding-right: 25px"
                class="slds-col--padded slds-size--1-of-5"
              >
                <lightning:button
                  label="Previous"
                  disabled="{!v.currentPageNumber == 1}"
                  onclick="{!c.previousPage}"
                />
                <lightning:button
                  label="Next"
                  variant="brand"
                  disabled="{!v.currentPageNumber*24 >= v.totalProducts}"
                  onclick="{!c.nextPage}"
                />
              </div>
            </div>
          </div>
        </p>
      </lightning:card>
    </aura:if>
  </div>
</aura:component>
